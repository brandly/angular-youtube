/*
  angular-youtube-mb v1.3.1
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",[]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,t){function r(e,t){return e.indexOf(t)>-1}function n(){t.$apply(function(){a.ready=!0})}var a={},i=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,o=/t=(\d+)[ms]?(\d+)?s?/;return a.getIdFromURL=function(e){var t=e.replace(i,"$1");if(r(t,";")){var n=t.split(";");if(r(n[1],"%")){var a=decodeURIComponent(n[1]);t=("http://youtube.com"+a).replace(i,"$1")}else t=n[0]}else r(t,"#")&&(t=t.split("#")[0]);return t},a.getTimeFromURL=function(e){e=e||"";var t=e.match(o);if(!t)return 0;var n=t[0],a=t[1],i=t[2];return"undefined"!=typeof i?(i=parseInt(i,10),a=parseInt(a,10)):r(n,"m")?(a=parseInt(a,10),i=0):(i=parseInt(a,10),a=0),i+60*a},a.ready=!1,"undefined"==typeof YT?(e.onYouTubeIframeAPIReady=n,console.log("Unable to find YouTube iframe library on this page.")):YT.loaded?a.ready=!0:YT.ready(n),a}]).directive("youtubeVideo",["$window","youtubeEmbedUtils",function(e,t){var r=1,n={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},a="youtube.player.";return e.YTConfig={host:"https://www.youtube.com"},{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(e,i,o){function d(){var t=Array.prototype.slice.call(arguments);e.$apply(function(){e.$emit.apply(e,t)})}function u(t){var r=n[t.data];"undefined"!=typeof r&&d(a+r,e.player,t),e.$apply(function(){e.player.currentState=r})}function l(t){d(a+"ready",e.player,t)}function y(t){d(a+"error",e.player,t)}function p(){var t=angular.copy(e.playerVars);t.start=t.start||e.urlStartTime;var r=new YT.Player(s,{height:e.playerHeight,width:e.playerWidth,videoId:e.videoId,playerVars:t});return r.addEventListener("onReady",l),r.addEventListener("onStateChange",u),r.addEventListener("onError",y),r.id=s,r}function f(){(e.videoId||e.playerVars.list)&&(e.player&&"function"==typeof e.player.destroy&&e.player.destroy(),e.player=p())}e.utils=t;var s=o.playerId||i[0].id||"unique-youtube-embed-id-"+r++;i[0].id=s,e.playerHeight=e.playerHeight||390,e.playerWidth=e.playerWidth||640,e.playerVars=e.playerVars||{};var c=e.$watch(function(){return e.utils.ready&&("undefined"!=typeof e.videoUrl||"undefined"!=typeof e.videoId||"undefined"!=typeof e.playerVars.list)},function(t){t&&(c(),"undefined"!=typeof e.videoUrl?e.$watch("videoUrl",function(t){e.videoId=e.utils.getIdFromURL(t),e.urlStartTime=e.utils.getTimeFromURL(t),f()}):"undefined"!=typeof e.videoId?e.$watch("videoId",function(){e.urlStartTime=null,f()}):e.$watch("playerVars.list",function(){e.urlStartTime=null,f()}))});e.$watchCollection(["playerHeight","playerWidth"],function(){e.player&&e.player.setSize(e.playerWidth,e.playerHeight)}),e.$on("$destroy",function(){e.player&&e.player.destroy(),i.remove(),i=null})}}}]);